---
import type { GetStaticPaths } from 'astro'
import { getCollection, render } from 'astro:content'

import Prose from '@/components/Prose.astro'
import { mdxComponents } from '@/components/utility/MDXComponents.astro'
import BlogPostLayout from '@/layouts/BlogPostLayout.astro'
import { shouldIncludeItem } from '@/lib/utils/content'

export const getStaticPaths = (async () => {
  const posts = await getCollection('blog', shouldIncludeItem)

  return posts.map((post) => ({
    params: { slug: post.id },
    props: { post },
  }))
}) satisfies GetStaticPaths

const { post } = Astro.props
const { Content } = await render(post)

const { data } = post
---

<BlogPostLayout {...data}>
  <Prose>
    <Content components={mdxComponents} />
  </Prose>
</BlogPostLayout>
