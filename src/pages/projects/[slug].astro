---
import type { GetStaticPaths } from 'astro'
import { getCollection, render } from 'astro:content'
import { shouldIncludeItem } from '@/lib/utils/content'
import ProjectLayout from '@/layouts/ProjectLayout.astro'
import Prose from '@/components/Prose.astro'
import { mdxComponents } from '@/components/utility/MDXComponents.astro'

export const getStaticPaths = (async () => {
  const projects = await getCollection('projects', shouldIncludeItem)

  return projects.map((project) => ({
    params: { slug: project.id },
    props: { project },
  }))
}) satisfies GetStaticPaths

const { project } = Astro.props
const { Content } = await render(project)

const { data } = project
---

<ProjectLayout {...data}>
  <Prose>
    <Content components={mdxComponents} />
  </Prose>
</ProjectLayout>
