---
import { cn } from '@/lib/utils/cn'
import type { ImageMetadata } from 'astro'
import { Image } from 'astro:assets'
import { Icon } from 'astro-icon/components'
import { formatDateMachine } from '@/lib/utils/date'

const IMAGE_CONFIG = {
  width: 304,
  densities: [1.5],
}

type Props = {
  title: string
  description: string
  targetUrl: string
  date: Date
  thumbnail: ImageMetadata
}

const { title, description, targetUrl, date, thumbnail } = Astro.props
---

<a
  href={targetUrl}
  class={cn(
    'border-base-content/15 group overflow-hidden rounded-xl border transition-colors duration-200 ease-out',
    'hover:border-base-content/30',
    'focus-visible:outline-primary focus-visible:outline-2 focus-visible:outline-offset-2',
  )}
>
  <article class={cn('flex h-full flex-col', 'lg:flex-row')}>
    <div class="aspect-og relative shrink-0 self-stretch overflow-hidden">
      <Image
        src={thumbnail}
        alt={title}
        class={cn(
          'size-full object-cover transition-transform duration-300 ease-out',
          'group-hover:scale-105 group-focus-visible:scale-105',
        )}
        {...IMAGE_CONFIG}
      />
      <time
        datetime={formatDateMachine(date)}
        class="badge badge-sm absolute top-1 left-1 font-bold">{date.getFullYear()}</time
      >
    </div>
    <div class="p-4">
      <h3 class="mb-3 line-clamp-2 text-lg font-bold">{title}</h3>
      <p class="text-base-content/75 mb-3 line-clamp-3">{description}</p>
      <span class="mt-auto inline-flex items-center gap-1"
        >Read more<Icon
          name="lucide:arrow-right"
          class="size-4 transition-transform duration-200 ease-out group-hover:translate-x-1 group-focus-visible:translate-x-1"
        /></span
      >
    </div>
  </article>
</a>
